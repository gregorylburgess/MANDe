<div class="span9">
	<div id="theForum">
	</div>
</div>

<script>
	var form = "<legend id=\"legend\">" + indexProps.Legend + "</legend>";
	delete formProps.Legend;
	fields = Object.keys(formProps);
	for (field in fields) {
		var name = fields[field];
		var value = formProps[name]
		form += "<label>" + name + "</label>";
		form += "<input id=\"" + name.toLowerCase().replace(/\s/g,'_') + "\" type=\"text\" value=\""+ value + "\">";
	}
	
	form += "</br><button type=\"submit\" class=\"btn\" onClick=\"submitForm()\">Submit</button>";
	$("#theForum").html(form);
	
	function submitForm() {
		var dic = new Array();
		for(field in fields) {
			name = fields[field].toLowerCase().replace(/\s/g,'_');
			value = $("#" + name).val();
			dic[name] = value;
		}
		dic = JSON.stringify(dic);
		/*dic = "{"
		var name = ""
		var value = ""
		for(field in fields) {
			name = fields[field].toLowerCase().replace(/\s/g,'_');
			value = $("#" + name).val();
			value = value.toString();
			dic += "\"" + name + "\":" + "\"" + value + "\",";
		}
		dic = dic.substring(0,dic.length-1)
		dic += "}";*/
		$.ajax({
			url: '../../query', 
			data: dic,
			success: parseResponse,
		})
	}
	
	function parseResponse(data) {
		data = $.parseJSON(data);
		toRet = "<h1>Results:</h1>";
		//Grab important keys
		params = data["params"];
		sensors = data['sensors'];
		stats = data['stats'];
		filenames = data['filenames'];
		
		//Re-Print params
		toRet += "<h3>Parameters:</h4>";
		for(key in params) {
			toRet += key + ": " + params[key] + "</br>"
		}
		
		toRet += "<h3>Stats:</h4>";
		for(key in stats) {
			toRet += key + ": " + stats[key] + "</br>";
		}
		
		toRet += "<h3>Graphs:</h4>";
		for(key in filenames) {
			toRet += "<image src=\"../" + filenames[key] + "\"></image>";
		}
		$('#theForum').html(toRet);
	}
</script>