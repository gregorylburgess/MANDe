<h2> Acousitc Package Developer Guide</h2>
This document discusses the general concepts and functionality included within the R package, as well as guidance on how to 
extend functionality.

<h3>General Program Flow</h3>
The package generally functions as follows:
1. Acquire bathymetry</br>
2. Simulate Animal Behavior</br>
3. Calculate the sumGrid</br>
4. Place user Sensors</br>
5. Suppress user Sensors</br>
6. Find optimal sensor placements</br>
7. Generate statistical & graphical data</br>
</br>
</br>

<h3>Grids</h3>
Within the program, several R matricies or "grids" are used frequently:</br>
<h4>fGrid:</h4> 
Represents the movement patterns of fish over a study period as a probability of their occupation of the cell.  The sum of all 
cells in the grid should equal 1.
</br>
<h4>bGrid:</h4> 
Contains the bathymetric data for each cell in the study area.  These are negative numbers representing depth in meters.
</br>
<h4>sumGrid:</h4> 
Represents the "goodness" of a particular cell.  This grid is generated from the bGrid and fGrid by a sumGrid function. Higher 
values indicate better choices.  Values must be positive real numbers.
</br>
</br>
<h3>Functionality</h3>
<h4>Bathymetry Acquisition</h4>
The generation of the bGrid is handled by the Bathy.R file.  Currently, only ArcGIS and NetCDF file formats are supported.  
The program uses R matricies to represent bathymetry, regardless of the original format of the bathymetry file.  It should be 
noted that certain R libraries transpose grided data when loading raw data into matricies.  The dimensions of 
the bGrid dictate the size of the fGrid, sumGrid, and coverageGrid.  
</br>
</br>
A useful addition to the progrm would be an interface that allowed the program to pull bathymetric data from a server that aggregates 
worldwide bathymetry (such as the one found here: 
<a href="http://maps.ngdc.noaa.gov/viewers/bathymetry/">http://maps.ngdc.noaa.gov/viewers/bathymetry/</a>).
</br>
</br>
<h4>Fish Modeling</h4>
The modeling of animal behavior is handled by the FishModel.R file.  The fish model has access to all parameters passed into the program, 
as well as a bGrid for the 
study area.  The fish() function makes the appropriate method calls based on the value of the <i>fishmodel</i> parameter. The primary 
role of fish modeling algorithms is to populate the fGrid with values between 0 and 1 representing the number of transmissions released 
from a cell as a percentage of all pings released durring the study.  Useful additions to this module would include the addition of modeling 
techniques and algorithms and support for multiple homeranges in the OU model.
</br></br>

<h4>sumGrid Functions:</h4>
sumGrid functions are functions that calculate a sumGrid for a given study area.  Functions of this type have function names starting with 
"sumGrid.".  The function <i>sumGrid.fun</i> is the handler for all sumGrid calls, and subsequently calls specific sumGrid functions based 
on the <i>bias</i> parameter.  The primary role of a sumGrid function is to assign to cells a numeric value positively corrolated with it's 
desirability as a sensor location.  Generally speaking, the calculation of the sumGrid is the most expensive calculation done by the program.
A useful improvement to this module would be multithreading the calculation of the sumGrid to reduce overall execution time.  The addition of 
other sumGrid functions would also increase the versatility of the program.
</br>
</br>
<h4>suppression Functions:</h4>
To find optimal sensor placements (step 6), the package uses a greedy algorithm over the sumGrid to find good candidates for sensor placement (
it chooses to place sensors in the (unoccupied) sumGrid cells with the largest values).  
Using this technique, it is possible that multiple cells will have the same goodness value (e.g. on a flat bathymetric plane with equal distribution 
of animals across the study area).  In these cases, the program will choose the first occurance of the highest valued cells.  This will result in 
sensors being clumped together in one corner of the study area.
</br><img class="dev-img" src="images/sumGrid-clump.png"></br>
In the above image, all the green cells are equally good choices for the program to pick.  As a result, the program picks the first few occurances 
of these green cells.  Any placement of sensors amongst green cells would be equally optimal, however the pictured network is rather awkward, 
providing no coverage for the northern end of the area of interest.  The primary role of suppression is to penalize cells of the sumGrid near 
sensors and create a more distributed network.  In doing so, the absoloute recovery rate of the network decreases, but unique recovery rate 
increases.  The above image shows a job which was run with a suppressionRangeFactor of 0 (indicating that no suppression should be used).  
The below image shows the same job, but with a suppressionRangeFactor of 2 (indicating that the system should suppress cells around a sensor
 out to twice the sensor's actual detection range.
</br><img class="dev-img" src="images/sumGrid-supp.png"></br>

</br>
Just as <i>sumGrid.fun</i> acts as a handler for sumGrid Functions, <i>suppress.opt</i> acts as a handler for suppression Functions.
</br>
</br>
<h4>Output Files</h4>
The program outputs a variety of data as text and graphics.  All jobs are given timestamps as a means of identifying the time at which the job 
was requested.
The progarm outputs:
A.txt file which lists raw R data (grids, parameters, outputs) in plain text,
Several .png files which represent the bGrid, fGrid, sumGrid, sensor coverage Map, and graphs pertaining to unique recovery rates.
A .zip file containing the .txt file and all .png files associated with the job.
All output filenames contain the timestamp provided by the user, or '-1' if no timestamp was provided.






